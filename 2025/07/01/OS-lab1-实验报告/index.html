<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>OS_lab1_实验报告 | lucky-sheltered-boy's Blog</title><meta name="author" content="Jiyuan Zhao"><meta name="copyright" content="Jiyuan Zhao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="1. 思考题 首先利用如下简单C语言程序(hello.c)来研究x86工具链和mips工具链的区别    先利用x86工具链编译并反汇编目标文件代码，并观察 12gcc -c hello.c -o hello.oobjdump -DS hello.o &gt; text.txt  最终text.txt内容如下：  再利用mips工具链编译后反汇编： 12mips-linux-gnu-gcc -c">
<meta property="og:type" content="article">
<meta property="og:title" content="OS_lab1_实验报告">
<meta property="og:url" content="http://example.com/2025/07/01/OS-lab1-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/index.html">
<meta property="og:site_name" content="lucky-sheltered-boy&#39;s Blog">
<meta property="og:description" content="1. 思考题 首先利用如下简单C语言程序(hello.c)来研究x86工具链和mips工具链的区别    先利用x86工具链编译并反汇编目标文件代码，并观察 12gcc -c hello.c -o hello.oobjdump -DS hello.o &gt; text.txt  最终text.txt内容如下：  再利用mips工具链编译后反汇编： 12mips-linux-gnu-gcc -c">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover5.JPG">
<meta property="article:published_time" content="2025-07-01T06:34:27.000Z">
<meta property="article:modified_time" content="2025-07-03T17:09:14.919Z">
<meta property="article:author" content="Jiyuan Zhao">
<meta property="article:tag" content="MOS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover5.JPG"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "OS_lab1_实验报告",
  "url": "http://example.com/2025/07/01/OS-lab1-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/",
  "image": "https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover5.JPG",
  "datePublished": "2025-07-01T06:34:27.000Z",
  "dateModified": "2025-07-03T17:09:14.919Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jiyuan Zhao",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/07/01/OS-lab1-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'OS_lab1_实验报告',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%BE%AE%E4%BF%A1%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover5.JPG);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">lucky-sheltered-boy's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">OS_lab1_实验报告</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">OS_lab1_实验报告</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-07-01T06:34:27.000Z" title="Created 2025-07-01 14:34:27">2025-07-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-07-03T17:09:14.919Z" title="Updated 2025-07-04 01:09:14">2025-07-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>10mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="1-思考题"><a href="#1-思考题" class="headerlink" title="1. 思考题"></a>1. 思考题</h1><ol>
<li><p>首先利用如下简单C语言程序(hello.c)来研究x86工具链和mips工具链的区别</p>
<p><img src="/pictures/5b095e4cf090a93ca2d0a95f5a8a1a2.png"></p>
</li>
</ol>
<p>先利用x86工具链编译并反汇编目标文件代码，并观察</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -c hello.c -o hello.o</span><br><span class="line">objdump -DS hello.o &gt; text.txt</span><br></pre></td></tr></table></figure>

<p>最终text.txt内容如下：</p>
<p><img src="/pictures/f3049ff3f5a73f6137d42b1bd89a79f.png"></p>
<p>再利用mips工具链编译后反汇编：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mips-linux-gnu-gcc -c hello.c -o hello.o</span><br><span class="line">mips-linux-gnu-objdump -DS hello.o &gt; text.txt</span><br></pre></td></tr></table></figure>

<p>最终输出如下：</p>
<p><img src="/pictures/9bb4fcb46e6ef43506536ce31f895d5.png"></p>
<p>之后再让x86的gcc把hello.c编译成可执行文件，之后再反汇编，代码如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc hello.c -o hello</span><br><span class="line">objdump -DS hello &gt; text.txt</span><br></pre></td></tr></table></figure>

<p>结果如下：</p>
<p><img src="/pictures/b5471bd18ddec43d40cfe5bcfe23549.png"></p>
<p>可以看到call指令后面填充了 puts@plt，说明在链接的时候这块函数地址被填上了。</p>
<p>再用mips工具链重复以上步骤：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mips-linux-gnu-gcc hello.c -o hello</span><br><span class="line">mips-linux-gnu-objdump hello &gt; text.txt</span><br></pre></td></tr></table></figure>

<p>结果如下：</p>
<p><img src="/pictures/acb897a296a2b5636449b1cfed4f6ed.png"></p>
<p>可以看到 lui 指令后的立即数不是0x0了，addiu 指令后的里结束也不是0了。此时 t9 寄存器的值不一样了，说明链接时函数地址被填上了。</p>
<p>objdump -DS 中，&#x3D;&#x3D;-D 表示 –disassemble-all，即反汇编所有部分的内容；-S表示 –source，即显示与反汇编汇合的源代码&#x3D;&#x3D;。 </p>
<ol start="2">
<li>先用 make 生成MOS内核的ELF文件，之后利用 .&#x2F;readelf target&#x2F;mos 去解析，结果如下：</li>
</ol>
<p><img src="/pictures/d9af4cd6b81b26037a6acdc833cbdb0.png"></p>
<p>以下是用系统工具readelf -S 解析的mos内核：</p>
<p><img src="/pictures/f9577e6bc4d019915c7933f78b04dca.png"></p>
<p>经过尝试发现 .&#x2F;readelf readelf 命令没有任何反应，但是 .&#x2F;readelf hello 命令可以正常输出。下面探究原因。通过输出 .&#x2F;readelf -h readelf 来解析readelf文件的文件头信息，内容如下：</p>
<p><img src="/pictures/b76c288abc8d1e18afecd8ee0c19e18.png"></p>
<p>而解析hello可执行文件的内容如下：</p>
<p><img src="/pictures/225fcb25506d0628bda8f58ac885633.png"></p>
<p>再结合makefile中的不同：</p>
<p><img src="/pictures/e95db4493607c7dc9c94d700aed6d0d.png"></p>
<p>可以看到 make hello 中多了 -m32 -static -g 三个参数。因此初步判断是 -m32 使得hello文件是32位的，而readelf默认生成为64位的了。我们的readelf只能解析32位的elf文件，因此无法解析自己。为了证明我们的判断，我们用readelf -h mos去查看mos内核的文件头，内容如下：</p>
<p><img src="/pictures/9387f11c2f2175f5d931b5aa53dfc3a.png"></p>
<p>可以看到mos内核也是32位的，因此我们的readelf可以解析mos内核。<br>经查询资料发现，系统工具readelf可以解析32位和64位的ELF文件格式。<strong>因此可以确定我们的readelf只能解析32位的程序，由于其本身是64位的，因此其自己无法解析自己，而系统工具readelf可以解析。</strong></p>
<ol start="3">
<li>实验中使用QEMU仿真模拟器来模拟硬件，而QEMU支持直接加载ELF文件格式的内核，因此QEMU相当于已经执行了bootloader的stage1过程了，此时硬件已经被初始化了，可以直接使用。而在stage2阶段，QEMU会加载内核到内存，之后跳转到内核的入口，从而完成启动。&#x3D;&#x3D;因此即使内核入口不是硬件的启动入口地址，也可以通过QEMU来跳转到内核的入口&#x3D;&#x3D;。</li>
</ol>
<h1 id="2-难点分析"><a href="#2-难点分析" class="headerlink" title="2. 难点分析"></a>2. 难点分析</h1><ol>
<li>首先是ELF文件格式的理解问题。ELF文件格式包含多种类型的文件，包括可重定位文件、可执行文件、共享对象文件等。ELF文件由几部分组成：首先是文件头，用来说明ELF文件的性质等信息，其中给出了段头表和节头表的偏移、大小等信息。其次是节头表，里面存储了文件的节的信息，地址等，用来在链接的时候把相同的节放在同一段中。还有段头表，也叫程序头表，它的作用是表明每一段的虚拟地址，方便在执行的时候把相应的段放入内存中。</li>
</ol>
<p>其中可重定位文件和可执行文件的区别如下：</p>
<table>
<thead>
<tr>
<th>特性</th>
<th>可重定位文件（Relocatable Files）</th>
<th>可执行文件（Executable Files）</th>
</tr>
</thead>
<tbody><tr>
<td><strong>文件类型</strong></td>
<td><code>ET_REL</code>（1）</td>
<td><code>ET_EXEC</code>（2）</td>
</tr>
<tr>
<td><strong>主要用途</strong></td>
<td>链接阶段，生成可执行文件或共享库</td>
<td>直接由操作系统加载并执行</td>
</tr>
<tr>
<td><strong>节（Sections）</strong></td>
<td>包含 <code>.text</code>、<code>.data</code>、<code>.bss</code> 等</td>
<td>通常不包含节，而是包含段（Segments）</td>
</tr>
<tr>
<td><strong>段（Segments）</strong></td>
<td>无程序头表</td>
<td>包含程序头表，描述如何加载到内存</td>
</tr>
<tr>
<td><strong>重定位信息</strong></td>
<td>包含重定位信息（如 <code>.rel.text</code>）</td>
<td>通常不包含重定位信息（除非动态链接）</td>
</tr>
<tr>
<td><strong>符号表</strong></td>
<td>包含完整的符号表（<code>.symtab</code>）</td>
<td>可能不包含完整的符号表</td>
</tr>
<tr>
<td><strong>入口点地址</strong></td>
<td>无入口点地址（<code>e_entry</code> 为 0）</td>
<td>包含入口点地址（<code>e_entry</code>）</td>
</tr>
<tr>
<td>2. 注意指针的加法。如果指针是void* 类型，例如 void * p &#x3D; 0x0，则 p + 3 &#x3D; 0x3，即p移动1* num个字节。&#x3D;&#x3D;而如果指针是其他类型，例如 int * p &#x3D;0x0，则 p + 3 &#x3D; 0xb，即p移动sizeof(int)* num个字节&#x3D;&#x3D;。因此我们想让指针只移动num个字节，需要保证指针是 void * 类型，或者指针指向的类型是一字节的。</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<ol start="3">
<li><p>在Linker Script 中书写段的内存定向时，要先确定放置的地址，此时需要用 . &#x3D; address;来表示接下来的段放在哪里。注意 &#x3D; 两边要有空格，以及行尾要有分号。之后可以接着写<br>.text : {* (.text)}<br>.data : {* (.data)}<br>等，用来表示把所有.text节组成的段放在相应地址上。</p>
</li>
<li><p>内核入口是在 Linker Script 中用ENTRY( _ start )定义的，即内核执行的第一行代码是_start函数。在_start函数中，我们设置了栈指针的位置，并跳转到了mips_init函数完成内核的C语言部分。</p>
</li>
<li><p>在printk函数的书写部分，我们需要注意每一个符号的判断，要记得初始化数据。最终的代码如下所示：</p>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">19</span>         <span class="keyword">for</span> (;;) &#123;</span><br><span class="line"> <span class="number">20</span>                 <span class="comment">/* scan for the next &#x27;%&#x27; */</span></span><br><span class="line"> <span class="number">21</span>                 <span class="comment">/* Exercise 1.4: Your code here. (1/8) */</span></span><br><span class="line"> <span class="number">22</span>                 <span class="keyword">while</span> ((*fmt)!=<span class="string">&#x27;\0&#x27;</span> &amp;&amp; (*fmt)!=<span class="string">&#x27;%&#x27;</span>) &#123;</span><br><span class="line"> <span class="number">23</span>                         out(data, fmt, <span class="number">1</span>);</span><br><span class="line"> <span class="number">24</span>                         fmt++;</span><br><span class="line"> <span class="number">25</span>                 &#125;</span><br><span class="line"> <span class="number">26</span>                 <span class="comment">/* flush the string found so far */</span></span><br><span class="line"> <span class="number">27</span>                 <span class="comment">/* Exercise 1.4: Your code here. (2/8) */</span></span><br><span class="line"> <span class="number">28</span>                 <span class="keyword">if</span> ((*fmt) == <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line"> <span class="number">29</span>                         <span class="keyword">break</span>;</span><br><span class="line"> <span class="number">30</span>                 &#125;</span><br><span class="line"> <span class="number">31</span>                 <span class="comment">/* check &quot;are we hitting the end?&quot; */</span></span><br><span class="line"> <span class="number">32</span>                 <span class="comment">/* Exercise 1.4: Your code here. (3/8) */</span></span><br><span class="line"> <span class="number">33</span>                 fmt++;</span><br><span class="line"> <span class="number">34</span>                 <span class="comment">/* we found a &#x27;%&#x27; */</span></span><br><span class="line"> <span class="number">35</span>                 <span class="comment">/* Exercise 1.4: Your code here. (4/8) */</span></span><br><span class="line"> <span class="number">36</span>                 ladjust = <span class="number">0</span>;</span><br><span class="line"> <span class="number">37</span>                 padc = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"> <span class="number">38</span>                 <span class="keyword">if</span> ((*fmt) == <span class="string">&#x27;-&#x27;</span>) &#123;</span><br><span class="line"> <span class="number">39</span>                         ladjust = <span class="number">1</span>;</span><br><span class="line"> <span class="number">40</span>                         fmt++;</span><br><span class="line"> <span class="number">41</span>                 &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((*fmt) == <span class="string">&#x27;0&#x27;</span>) &#123;</span><br><span class="line"> <span class="number">42</span>                         padc = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"> <span class="number">43</span>                         fmt++;</span><br><span class="line"> <span class="number">44</span>                 &#125;</span><br><span class="line"> <span class="number">45</span>                 <span class="comment">/* check format flag */</span></span><br><span class="line"> <span class="number">46</span>                 <span class="comment">/* Exercise 1.4: Your code here. (5/8) */</span></span><br><span class="line"> <span class="number">47</span>                 width = <span class="number">0</span>;</span><br><span class="line"> <span class="number">48</span>                 <span class="keyword">while</span> ((*fmt) &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; (*fmt) &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line"> <span class="number">49</span>                         width = width*<span class="number">10</span> + (*fmt) - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"> <span class="number">50</span>                         fmt++;</span><br><span class="line"> <span class="number">51</span>                 &#125;</span><br><span class="line"> <span class="number">52</span>                 <span class="comment">/* get width */</span></span><br><span class="line"> <span class="number">53</span>                 <span class="comment">/* Exercise 1.4: Your code here. (6/8) */</span></span><br><span class="line"> <span class="number">54</span>                 long_flag = <span class="number">0</span>;</span><br><span class="line"> <span class="number">55</span>                 <span class="keyword">while</span> ((*fmt) == <span class="string">&#x27;l&#x27;</span>) &#123;</span><br><span class="line"> <span class="number">56</span>                         long_flag = <span class="number">1</span>;</span><br><span class="line"> <span class="number">57</span>                         fmt++;</span><br><span class="line"> <span class="number">58</span>                 &#125;</span><br><span class="line"> <span class="number">59</span>                 <span class="comment">/* check for long */</span></span><br><span class="line"> <span class="number">60</span>                 <span class="comment">/* Exercise 1.4: Your code here. (7/8) */</span></span><br><span class="line"> <span class="number">61</span> </span><br><span class="line"> <span class="number">62</span>                 neg_flag = <span class="number">0</span>;</span><br><span class="line"> <span class="number">63</span>                 <span class="keyword">switch</span> (*fmt) &#123;</span><br><span class="line"> <span class="number">64</span>                 <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line"> <span class="number">65</span>                         <span class="keyword">if</span> (long_flag) &#123;</span><br><span class="line"> <span class="number">66</span>                                 num = va_arg(ap, <span class="type">long</span> <span class="type">int</span>);</span><br><span class="line"> <span class="number">67</span>                         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="number">68</span>                                 num = va_arg(ap, <span class="type">int</span>);</span><br><span class="line"> <span class="number">69</span>                         &#125;</span><br><span class="line"> <span class="number">70</span>                         print_num(out, data, num, <span class="number">2</span>, <span class="number">0</span>, width, ladjust, padc, <span class="number">0</span>);</span><br><span class="line"> <span class="number">71</span>                         <span class="keyword">break</span>;</span><br><span class="line"> <span class="number">72</span> </span><br><span class="line"> <span class="number">73</span>                 <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line"> <span class="number">74</span>                 <span class="keyword">case</span> <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line"> <span class="number">75</span>                         <span class="keyword">if</span> (long_flag) &#123;</span><br><span class="line"> <span class="number">76</span>                                 num = va_arg(ap, <span class="type">long</span> <span class="type">int</span>);</span><br><span class="line"> <span class="number">77</span>                         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="number">78</span>                                 num = va_arg(ap, <span class="type">int</span>);</span><br><span class="line"> <span class="number">79</span>                         &#125;</span><br><span class="line"> <span class="number">80</span> </span><br><span class="line"> <span class="number">81</span>                         <span class="comment">/*</span></span><br><span class="line"><span class="comment"> 82                          * Refer to other parts (case &#x27;b&#x27;, case &#x27;o&#x27;, etc.) and func &#x27;print_num&#x27; to</span></span><br><span class="line"><span class="comment"> 83                          * complete this part. Think the differences between case &#x27;d&#x27; and the</span></span><br><span class="line"><span class="comment"> 84                          * others. (hint: &#x27;neg_flag&#x27;).</span></span><br><span class="line"><span class="comment"> 85                          */</span></span><br><span class="line"> <span class="number">86</span>                         <span class="comment">/* Exercise 1.4: Your code here. (8/8) */</span></span><br><span class="line"> <span class="number">87</span>                         <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line"> <span class="number">88</span>                                 neg_flag = <span class="number">1</span>;</span><br><span class="line"> <span class="number">89</span>                                 num = -num;</span><br><span class="line"> <span class="number">90</span>                         &#125;</span><br><span class="line"> <span class="number">91</span>                         print_num(out, data, num, <span class="number">10</span>, neg_flag, width, ladjust, padc, <span class="number">0</span>);</span><br><span class="line"> <span class="number">92</span>                         <span class="keyword">break</span>;</span><br><span class="line"> <span class="number">93</span> </span><br><span class="line"> <span class="number">94</span>                 <span class="keyword">case</span> <span class="string">&#x27;o&#x27;</span>:</span><br><span class="line"> <span class="number">95</span>                 <span class="keyword">case</span> <span class="string">&#x27;O&#x27;</span>:</span><br><span class="line"> <span class="number">96</span>                         <span class="keyword">if</span> (long_flag) &#123;</span><br><span class="line"> <span class="number">97</span>                                 num = va_arg(ap, <span class="type">long</span> <span class="type">int</span>);</span><br><span class="line"> <span class="number">98</span>                         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="number">99</span>                                 num = va_arg(ap, <span class="type">int</span>);</span><br><span class="line"><span class="number">100</span>                         &#125;</span><br><span class="line"><span class="number">101</span>                         print_num(out, data, num, <span class="number">8</span>, <span class="number">0</span>, width, ladjust, padc, <span class="number">0</span>);</span><br><span class="line"><span class="number">102</span>                         <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p>同时注意变长参数的使用方法，如下图所示：</p>
<p><img src="/pictures/2e37b2eaf9e998328eeddaf04db883c.png"><br>需要先用 va_list ap;声明一个变量。再用 va_start(ap, lastarg);进行初始化。<br>每次获取参数可以用 va_arg(ap, int);获取。其中int为该变量的类型。<br>最后结束的时候要用 va_end(ap);来结束变量。</p>
<h1 id="3-实验体会"><a href="#3-实验体会" class="headerlink" title="3. 实验体会"></a>3. 实验体会</h1><p>本次实验需要认真体会，反复观看，才能很好的掌握整体逻辑。我在前几次看指导书的时候，都有种不知所云的感觉，感觉读了但不知道在说什么；对于做题也只是简单的完成本题的任务，但不清楚这个题目在整体启动过程中是哪一步骤，发挥了什么作用。这使得我对于整体开机的顺序还是模糊的。</p>
<p>在初次完成任务后，我又在写实验报告的时候认真重温了一遍指导书，这才稍有眉目，多了解了一些内容，并明确了每一部分是在干什么。</p>
<p>我自己理解了一点lab1的内容，不知道对不对，想请大家斧正一下。真正的计算机启动主要分为：硬件启动和内核启动。其中硬件启动在Linux系统上是，当按下电源后，计算机先运行BIOS的代码，这部分代码是存储在断电不丢失的ROM上的，因为这是最最最开始运行的代码，不会被其他方式加载，只能存储在硬件上。之后BIOS进行硬件自检后加载MBR，并运行MBR中的bootloader部分，Linux系统中主要是GRUB或LILO。bootloader分为两部分：stage1先简单初始化硬件，之后初始化RAM，加载stage2代码到RAM中，跳转到stage2入口；stage2再初始化相关硬件，加载内核到内存中（这部分是lab1实验完成的部分），配置内核参数，然后跳转到内核的入口，即把CPU控制权给内核，之后便运行内核代码完成进一步初始化。我们的lab1实验主要是聚焦于加载内核到内存中这一阶段？我们用的是QEMU模拟器，支持直接加载ELF格式的内核，我理解的意思就是QEMU自动完成了加载内核到内存这一步之前的所有操作？我们在实验中通过make来编译链接出mos内核，也就是说内核在make之前是不存在的，那真实启动中，是bootloader来完成make这一任务来创生出内核么？还是通过给定路径去解压下载（这样的话内核一开始是存在的）？这部分完成后只是有了内核，但是还没放到内存中，内核本质是ELF文件格式，它不能自己把自己放到内存中，只是通过段头表给出了每段的虚拟地址而已，那是不是OS根据其段头表的地址把内核的段放到内存中的？ELF中有内核的入口地址en_entry，是不是OS在配置好内核参数后，跳转到entry运行，从而完成跳转到内核入口这一过程？</p>
<p>如果以上内容大致方向理解正确，那我们lab1实验其实没有干任何OS要干的事（应该）只是在完成内核信息而已。我们写的readelf.c跟内核本身没关系，只是为了帮助我们理解ELF文件格式而已；我们写的 LinkerScript 的链接地址，在make后会决定mos内核的段头表的地址，等待后续被OS参考并放入内存；我们补充的_start.S的代码，是内核的入口函数的代码，也是CPU控制权交给内核后运行的代码，之后的 mips_init 会进一步初始化内核。这么多工作其实都只是在完善mos内核而已，我们也没有真正把内核放入内存中，只是给出了地址。所以OS的工作我们还没做？</p>
<h1 id="4-原创声明"><a href="#4-原创声明" class="headerlink" title="4. 原创声明"></a>4. 原创声明</h1><p>以上内容大部分为原创。少部分参考了<a target="_blank" rel="noopener" href="https://www.cnblogs.com/emodiary121/p/16061297.html">北航操作系统课程lab1实验报告 - 南风北辰 - 博客园 (cnblogs.com)</a>该博客。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">Jiyuan Zhao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2025/07/01/OS-lab1-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/">http://example.com/2025/07/01/OS-lab1-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MOS/">MOS</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover5.JPG" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/01/OS-lab0-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab0_实验报告"><img class="cover" src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover7.JPG" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">OS_lab0_实验报告</div></div><div class="info-2"><div class="info-item-1">1. 思考题 &#x3D;&#x3D;不一样&#x3D;&#x3D;。在第一次 git add 之前文件 README.txt 属于未跟踪的文件，此时 git 是无法管理这个文件的，因此 git status 显示未跟踪的文件；而在 git add 并 git commit 之后，git 开始管理这个文件，此时再修改后其状态就会变成已修改未暂存的文件。&#x3D;&#x3D;其根本原因就是 git 是否管理了这个文件&#x3D;&#x3D;。如果 git 不管理这个文件，那么这个文件的状态一直都是 untracked ，一旦 git 管理了这个文件，那么经过修改后就会变成 changes not staged for commit ，git add 之后就都是 changes to be committed。  图中，add the file 对应指令 git add，stage the file 对应指令 git add，commit 对应 git commit。  当删除了 print.c 后，可以用 git restore print.c &#x2F; git...</div></div></div></a><a class="pagination-related" href="/2025/07/01/OS-lab2-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab2_实验报告"><img class="cover" src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover6.JPG" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">OS_lab2_实验报告</div></div><div class="info-2"><div class="info-item-1">1. 思考题 在编写的 C 程序中，指针变量中存储的地址被视为虚拟地址，MIPS 汇编程序中 lw 和 sw 指令使用的地址也被视为虚拟地址。CPU访问的都是虚拟地址，通过MMU来转换成对应的物理地址，最后访问内存中的数据。  首先，用宏来处理链表可以化简链表的操作，通过将特定功能的代码封装在宏定义中，可以在实现特定功能时简化操作，增加代码可读性和可维护性。其次，当链表的操作需要修改时，由于该操作会被大量复用，如果逐一修改工作量太大，而用宏则可以只修改宏定义，方便更改。最后，很多种类的链表都包含相似的操作，只要这些链表结构相同，就都可以用这些宏定义来实现相似的操作，只是传入的参数不同，方便了众多链表的使用。 在实验环境中，有单向链表、双向链表、单向队列、双向队列、循环队列。  ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/01/OS-lab0-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab0_实验报告"><img class="cover" src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover7.JPG" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-01</div><div class="info-item-2">OS_lab0_实验报告</div></div><div class="info-2"><div class="info-item-1">1. 思考题 &#x3D;&#x3D;不一样&#x3D;&#x3D;。在第一次 git add 之前文件 README.txt 属于未跟踪的文件，此时 git 是无法管理这个文件的，因此 git status 显示未跟踪的文件；而在 git add 并 git commit 之后，git 开始管理这个文件，此时再修改后其状态就会变成已修改未暂存的文件。&#x3D;&#x3D;其根本原因就是 git 是否管理了这个文件&#x3D;&#x3D;。如果 git 不管理这个文件，那么这个文件的状态一直都是 untracked ，一旦 git 管理了这个文件，那么经过修改后就会变成 changes not staged for commit ，git add 之后就都是 changes to be committed。  图中，add the file 对应指令 git add，stage the file 对应指令 git add，commit 对应 git commit。  当删除了 print.c 后，可以用 git restore print.c &#x2F; git...</div></div></div></a><a class="pagination-related" href="/2025/07/01/OS-lab2-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab2_实验报告"><img class="cover" src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover6.JPG" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-01</div><div class="info-item-2">OS_lab2_实验报告</div></div><div class="info-2"><div class="info-item-1">1. 思考题 在编写的 C 程序中，指针变量中存储的地址被视为虚拟地址，MIPS 汇编程序中 lw 和 sw 指令使用的地址也被视为虚拟地址。CPU访问的都是虚拟地址，通过MMU来转换成对应的物理地址，最后访问内存中的数据。  首先，用宏来处理链表可以化简链表的操作，通过将特定功能的代码封装在宏定义中，可以在实现特定功能时简化操作，增加代码可读性和可维护性。其次，当链表的操作需要修改时，由于该操作会被大量复用，如果逐一修改工作量太大，而用宏则可以只修改宏定义，方便更改。最后，很多种类的链表都包含相似的操作，只要这些链表结构相同，就都可以用这些宏定义来实现相似的操作，只是传入的参数不同，方便了众多链表的使用。 在实验环境中，有单向链表、双向链表、单向队列、双向队列、循环队列。  ...</div></div></div></a><a class="pagination-related" href="/2025/07/01/OS-lab3-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab3_实验报告"><img class="cover" src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-01</div><div class="info-item-2">OS_lab3_实验报告</div></div><div class="info-2"><div class="info-item-1">1. 思考题 首先，MIPS中的虚拟内存结构如下： 因此，base_pgdir中建立了pages和envs的物理地址与虚存中pages和envs的虚拟地址之间的关系，这也同样解释了在map_segment中传入的UPAGES和UENVS的含义，就是pages和envs的虚存首地址。 之后，由于MOS的内核数据共享机制，需要把UTOP以上UVPT以下，即pages和envs的数据暴露给用户空间，因为base_pgdir中已经有分配好的映射关系，因此需要把UTOP到UVPT所对应的页目录项赋值给每个进程的页目录。又由于用户自身的4MB页表放置在UVPT，因此页目录自映射项相对于页目录的偏移即为PDX(UVPT)，因此需要把e-&gt;env_pgdir[PDX(UVPT)] &#x3D; PADDR(e-&gt;env_pgdir) |...</div></div></div></a><a class="pagination-related" href="/2025/07/01/OS-lab5-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab5_实验报告"><img class="cover" src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-01</div><div class="info-item-2">OS_lab5_实验报告</div></div><div class="info-2"><div class="info-item-1">1. 思考题 使用kseg0去读写设备，会导致读取的数据可能不正确。因为kseg0段使用cache来访存，当CPU访问一个物理地址时，会先检查该地址所在块是否在cache中，如果在那么直接从cache中进行读或写，如果不在那么申请一块并从内存中读取该块的内容到cache中，并重新访问。这样做之所以可行是因为对cache中的块的数据进行操作等效于对内存直接操作。但是如果外设对内存的操作不会引起cache的变化，如果外设对内存中的数据进行了修改，那么cache中对应块没有随之修改，这就会导致cache中的块的数据和内存中块数据不一致，导致CPU访问的时候读取到了错误的数据。同理CPU的写入也会先写进cache，之后再回写到内存中，这样会导致外设有可能读不到CPU写入的数据。  一个磁盘块的大小是4KB，也就是4096字节；而一个文件控制块FCB的大小固定为256字节，因此一个磁盘块中最多能存储16个文件控制块。一个目录最多拥有1024个磁盘块，因此最多能有16384个文件。我们文件系统支持单个文件最多拥有1024个磁盘块，也就是4MB。 缓冲区的范围是 [DISKMAP,...</div></div></div></a><a class="pagination-related" href="/2025/07/01/OS-lab4-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab4_实验报告"><img class="cover" src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover4.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-01</div><div class="info-item-2">OS_lab4_实验报告</div></div><div class="info-2"><div class="info-item-1">1. 思考题  内核在保存现场的时候，通过 SAVE_ALL 宏操作，来将通用寄存器中的值保存在内核栈指针所指向的位置，在异常处理结束时恢复现场，从而防止通用寄存器的值被破坏改变。 可以从当时的 $a0 - $a3 寄存器中得到用户调用 msyscall 时传入的参数。因为在系统调用的时候，这几个寄存器的值不会被改变，因此可以直接获取。 方式就是让sys开头的函数通过正常获取参数的方式，能够获取正确的参数。而这样做的保证是，在用户调用syscall相关函数后，会进行传参，此时会在$a0 - $a3寄存器中保存值，并在用户栈中开辟栈帧，存入相关参数。之后调用msyscall函数，这个函数是个页函数，因此没有栈帧，不会改变栈指针的位置，这个函数直接调用了syscall，陷入了内核态，因此此时 $a0 - $a3...</div></div></div></a><a class="pagination-related" href="/2025/07/01/OS-lab6-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab6_实验报告"><img class="cover" src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover8.JPG" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-01</div><div class="info-item-2">OS_lab6_实验报告</div></div><div class="info-2"><div class="info-item-1">1. 思考题想让父进程作为读者，只需要反过来操作就可以了。先关闭写，再进行读操作，最后关闭读并退出即可。代码如下： 123456default:	close(fildes[1]);	read(fildes[0], buf, 100);	printf(&quot;father-process read:%s&quot;, buf);	close(fildes[0]);	exit(EXIT_SUCCESS); dup...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%BE%AE%E4%BF%A1%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jiyuan Zhao</div><div class="author-info-description">这里是keshi的博客网站，联系作者：zhaojiyuan0721</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lucky-sheltered-boy"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/lucky-sheltered-boy" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:23371524@buaa.edu.cn" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E6%80%9D%E8%80%83%E9%A2%98"><span class="toc-number">1.</span> <span class="toc-text">1. 思考题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E9%9A%BE%E7%82%B9%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">2. 难点分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%AE%9E%E9%AA%8C%E4%BD%93%E4%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">3. 实验体会</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%8E%9F%E5%88%9B%E5%A3%B0%E6%98%8E"><span class="toc-number">4.</span> <span class="toc-text">4. 原创声明</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/08/23/LLM-MoE-RL-%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/" title="LLM MoE RL 学习报告"><img src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover6.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LLM MoE RL 学习报告"/></a><div class="content"><a class="title" href="/2025/08/23/LLM-MoE-RL-%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/" title="LLM MoE RL 学习报告">LLM MoE RL 学习报告</a><time datetime="2025-08-23T02:15:17.000Z" title="Created 2025-08-23 10:15:17">2025-08-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/01/OS-lab6-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab6_实验报告"><img src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover8.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OS_lab6_实验报告"/></a><div class="content"><a class="title" href="/2025/07/01/OS-lab6-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab6_实验报告">OS_lab6_实验报告</a><time datetime="2025-07-01T06:35:01.000Z" title="Created 2025-07-01 14:35:01">2025-07-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/01/OS-lab5-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab5_实验报告"><img src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OS_lab5_实验报告"/></a><div class="content"><a class="title" href="/2025/07/01/OS-lab5-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab5_实验报告">OS_lab5_实验报告</a><time datetime="2025-07-01T06:34:53.000Z" title="Created 2025-07-01 14:34:53">2025-07-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/01/OS-lab4-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab4_实验报告"><img src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OS_lab4_实验报告"/></a><div class="content"><a class="title" href="/2025/07/01/OS-lab4-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab4_实验报告">OS_lab4_实验报告</a><time datetime="2025-07-01T06:34:46.000Z" title="Created 2025-07-01 14:34:46">2025-07-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/01/OS-lab3-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab3_实验报告"><img src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN2/post/cover3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OS_lab3_实验报告"/></a><div class="content"><a class="title" href="/2025/07/01/OS-lab3-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="OS_lab3_实验报告">OS_lab3_实验报告</a><time datetime="2025-07-01T06:34:40.000Z" title="Created 2025-07-01 14:34:40">2025-07-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By Jiyuan Zhao</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>